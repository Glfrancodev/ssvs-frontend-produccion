import{a as U}from"./chunk-WBEXYDI3.js";import{a as Y}from"./chunk-2AXTMM6U.js";import{a as X}from"./chunk-QZX63QLI.js";import{a as Z}from"./chunk-NY3PXWMS.js";import{a as A,b as R}from"./chunk-G3JGI5Y7.js";import{a as J,b as Q}from"./chunk-FXNARXVT.js";import{B as q,f as B,k as L,n as j,s as z,t as G,u as K}from"./chunk-F7MBEHRF.js";import{d as F,e as N,j as k}from"./chunk-24563CTF.js";import"./chunk-4YRY4IP2.js";import"./chunk-EALBQTKK.js";import{m as D,p as V,q as W}from"./chunk-5DWL5JJZ.js";import{$a as h,Ab as a,Bb as f,Cb as P,Eb as _,Fb as b,Gb as M,Ib as I,Jb as H,Na as c,Oa as g,Sb as O,Tb as T,_ as S,a as x,b as w,cb as p,ha as m,hb as n,ia as u,ib as o,jb as y,nb as v,qb as C,rb as s}from"./chunk-3RWLLOHT.js";var $=()=>({"min-width":"50rem"});function ee(r,d){if(r&1){let e=v();n(0,"div",1)(1,"label",6),a(2,"M\xE9dico"),o(),n(3,"p-dropdown",7),M("ngModelChange",function(i){m(e);let l=s();return b(l.selectedMedico,i)||(l.selectedMedico=i),u(i)}),C("onChange",function(){m(e);let i=s();return u(i.onMedicoChange())}),o()()}if(r&2){let e=s();c(3),p("options",e.medicos),_("ngModel",e.selectedMedico)}}function ie(r,d){if(r&1){let e=v();n(0,"div",1)(1,"label",8),a(2,"Horario"),o(),n(3,"p-dropdown",9),M("ngModelChange",function(i){m(e);let l=s();return b(l.selectedHorario,i)||(l.selectedHorario=i),u(i)}),C("onChange",function(){m(e);let i=s();return u(i.onHorarioChange())}),o()()}if(r&2){let e=s();c(3),p("options",e.horarios),_("ngModel",e.selectedHorario)}}function oe(r,d){r&1&&(n(0,"tr")(1,"th"),a(2,"N\xFAmero"),o(),n(3,"th"),a(4,"Fecha Reservada"),o(),n(5,"th"),a(6,"Hora"),o(),n(7,"th"),a(8,"Estado"),o(),n(9,"th"),a(10,"Asegurado"),o()())}function te(r,d){if(r&1&&(n(0,"tr")(1,"td"),a(2),o(),n(3,"td"),a(4),O(5,"date"),o(),n(6,"td"),a(7),o(),n(8,"td"),a(9),o(),n(10,"td"),a(11),o()()),r&2){let e=d.$implicit;c(2),f(e.numero),c(2),f(e.fechaReservado?T(5,5,e.fechaReservado,"dd/MM/yyyy"):"No reservada"),c(3),f(e.hora),c(2),f(e.estado),c(2),P(" ",e.asegurado?e.asegurado.usuario.nombre+" "+e.asegurado.usuario.apellido:"Sin asegurado"," ")}}function ne(r,d){if(r&1&&(n(0,"div",10)(1,"h3"),a(2,"Cupos Disponibles"),o(),n(3,"p-table",11),h(4,oe,11,0,"ng-template",12)(5,te,12,8,"ng-template",13),o()()),r&2){let e=s();c(3),p("value",e.cupos)("tableStyle",H(2,$))}}var E=class r{constructor(d,e,t,i){this.especialidadService=d;this.medicoEspecialidadService=e;this.horarioService=t;this.cupoService=i}especialidades=[];horarios=[];cupos=[];selectedEspecialidad=null;selectedMedico=null;selectedMedicoEspecialidad;selectedHorario=null;medicos=[];ngOnInit(){this.obtenerEspecialidades()}obtenerEspecialidades(){this.especialidadService.getEspecialidades().subscribe(d=>{this.especialidades=d})}onEspecialidadChange(){this.selectedEspecialidad&&this.selectedEspecialidad.id!==void 0?this.obtenerMedicosPorEspecialidad(this.selectedEspecialidad.id):this.medicos=[]}obtenerMedicosPorEspecialidad(d){this.medicoEspecialidadService.getMedicoEspecialidades().subscribe(e=>{let t=e.filter(i=>i.especialidad.id===d&&i.medico!==void 0).map(i=>({id:i.medico.id,nombreCompleto:`${i.medico.usuario.nombre} ${i.medico.usuario.apellido}`}));this.medicos=t})}onMedicoChange(){this.selectedEspecialidad?.id!==void 0&&this.selectedMedico?.id!==void 0?this.medicoEspecialidadService.getMedicoEspecialidadByEspecialidadAndMedico(this.selectedEspecialidad.id,this.selectedMedico.id).subscribe(d=>{this.selectedMedicoEspecialidad=d,console.log("MedicoEspecialidad seleccionado:",this.selectedMedicoEspecialidad),this.obtenerHorariosPorMedicoEspecialidad(this.selectedMedicoEspecialidad.id)}):this.selectedMedicoEspecialidad=null}obtenerHorariosPorMedicoEspecialidad(d){this.horarioService.getHorariosPorMedicoEspecialidad(d).subscribe(e=>{this.horarios=e.map(t=>w(x({},t),{label:`${t.fecha} - ${t.horaInicio} a ${t.horaFinal}`}))})}obtenerCuposPorHorario(d){this.cupoService.getCuposPorHorario(d).subscribe(e=>{this.cupos=e})}onHorarioChange(){this.selectedHorario&&this.selectedHorario.id?this.obtenerCuposPorHorario(this.selectedHorario.id):this.cupos=[]}static \u0275fac=function(e){return new(e||r)(g(U),g(X),g(Y),g(Z))};static \u0275cmp=S({type:r,selectors:[["app-cupo"]],standalone:!0,features:[I],decls:11,vars:5,consts:[[1,"form-container","add-usuario-form"],[1,"form-field"],["for","especialidad"],["optionLabel","nombre","placeholder","Seleccione una especialidad",1,"input-dropdown",3,"ngModelChange","onChange","options","ngModel"],["class","form-field",4,"ngIf"],["class","cupo-table",4,"ngIf"],["for","medico"],["optionLabel","nombreCompleto","placeholder","Seleccione un m\xE9dico",1,"input-dropdown",3,"ngModelChange","onChange","options","ngModel"],["for","horario"],["optionLabel","label","placeholder","Seleccione un horario",1,"input-dropdown",3,"ngModelChange","onChange","options","ngModel"],[1,"cupo-table"],["dataKey","numero",3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"]],template:function(e,t){e&1&&(y(0,"p-toast"),n(1,"div",0)(2,"h3"),a(3,"Seleccione Especialidad, M\xE9dico y Horario"),o(),n(4,"div",1)(5,"label",2),a(6,"Especialidad"),o(),n(7,"p-dropdown",3),M("ngModelChange",function(l){return b(t.selectedEspecialidad,l)||(t.selectedEspecialidad=l),l}),C("onChange",function(){return t.onEspecialidadChange()}),o()(),h(8,ee,4,2,"div",4)(9,ie,4,2,"div",4),o(),h(10,ne,6,3,"div",5)),e&2&&(c(7),p("options",t.especialidades),_("ngModel",t.selectedEspecialidad),c(),p("ngIf",t.medicos.length>0),c(),p("ngIf",t.horarios.length>0),c(),p("ngIf",t.cupos.length>0))},dependencies:[W,D,V,Q,J,B,G,z,q,K,k,F,N,j,L,R,A],styles:[".form-container[_ngcontent-%COMP%]{padding:1.5rem;border:1px solid #dcdcdc;border-radius:12px;background-color:#f9f9f9;box-shadow:0 4px 8px #0000001a;margin-bottom:1.5rem;display:grid;grid-template-columns:1fr 1fr;gap:1rem}.form-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{grid-column:1 / -1;font-size:1.8rem;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:1rem;border-bottom:2px solid #ddd;padding-bottom:.5rem}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333;margin-bottom:.25rem}.input-dropdown[_ngcontent-%COMP%]{width:100%;max-width:100%;padding:.5rem;border-radius:6px;border:1px solid #ddd;background-color:#fff;font-size:.95rem;box-shadow:inset 0 1px 3px #0000001a}.input-dropdown[_ngcontent-%COMP%]:focus{outline:none;border-color:#3f51b5;box-shadow:0 0 4px #3f51b54d}.cupo-table[_ngcontent-%COMP%]{width:100%;max-width:100%;padding:1rem;border-radius:12px;background-color:#fff;box-shadow:0 4px 8px #0000001a;margin-top:1.5rem}.cupo-table[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.6rem;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:1rem;border-bottom:2px solid #ddd;padding-bottom:.5rem}.p-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;font-weight:700;text-align:center;padding:12px}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f7f7f7}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0f7fa}.p-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:center;vertical-align:middle}"]})};export{E as default};
