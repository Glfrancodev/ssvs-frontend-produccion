import{a as F}from"./chunk-U4TB2UQV.js";import{a as V}from"./chunk-MK7CEOIY.js";import{B,f as w,l as R,n as T,u as A}from"./chunk-WB7R4CTM.js";import"./chunk-TCU2USIY.js";import"./chunk-4YRY4IP2.js";import{o as D}from"./chunk-OAPWJZOF.js";import{m as y,p as k,q as I}from"./chunk-4YUBQKU5.js";import{Eb as S,Ja as c,Ka as b,Ob as O,Pb as P,W as M,Xa as C,_a as u,da as m,db as n,ea as g,eb as o,jb as _,mb as f,nb as d,wb as i,xb as p,zb as E}from"./chunk-VM3UWR7T.js";import{a as h,b as x}from"./chunk-ODN5LVDJ.js";function j(r,t){r&1&&(n(0,"tr")(1,"th"),i(2,"ID"),o(),n(3,"th"),i(4,"N\xFAmero"),o(),n(5,"th"),i(6,"M\xE9dico"),o(),n(7,"th"),i(8,"Especialidad"),o(),n(9,"th"),i(10,"Fecha Reservada"),o(),n(11,"th"),i(12,"Hora"),o(),n(13,"th"),i(14,"Acci\xF3n"),o()())}function N(r,t){if(r&1){let e=_();n(0,"button",7),f("click",function(){m(e);let s=d().$implicit,l=d();return g(l.confirmDelete(s))}),o()}}function $(r,t){if(r&1){let e=_();n(0,"button",8),f("click",function(){m(e);let s=d().$implicit,l=d();return g(l.liberarCupo(s))}),o()}}function z(r,t){if(r&1){let e=_();n(0,"button",9),f("click",function(){m(e);let s=d().$implicit,l=d();return g(l.cancelDelete(s))}),o()}}function L(r,t){if(r&1&&(n(0,"tr")(1,"td"),i(2),o(),n(3,"td"),i(4),o(),n(5,"td"),i(6),o(),n(7,"td"),i(8),o(),n(9,"td"),i(10),O(11,"date"),o(),n(12,"td"),i(13),o(),n(14,"td")(15,"div",3),C(16,N,1,0,"button",4)(17,$,1,0,"button",5)(18,z,1,0,"button",6),o()()()),r&2){let e=t.$implicit;c(2),p(e.id),c(2),p(e.numero),c(2),E("",e.horario==null||e.horario.medicoEspecialidad==null||e.horario.medicoEspecialidad.medico==null||e.horario.medicoEspecialidad.medico.usuario==null?null:e.horario.medicoEspecialidad.medico.usuario.nombre," ",e.horario==null||e.horario.medicoEspecialidad==null||e.horario.medicoEspecialidad.medico==null||e.horario.medicoEspecialidad.medico.usuario==null?null:e.horario.medicoEspecialidad.medico.usuario.apellido,""),c(2),p(e.horario==null||e.horario.medicoEspecialidad==null||e.horario.medicoEspecialidad.especialidad==null?null:e.horario.medicoEspecialidad.especialidad.nombre),c(2),p(P(11,10,e.fechaReservado,"dd/MM/yyyy")),c(3),p(e.hora),c(3),u("ngIf",!e.isDeleting),c(),u("ngIf",e.isDeleting),c(),u("ngIf",e.isDeleting)}}var v=class r{constructor(t,e,a){this.cupoService=t;this.authService=e;this.aseguradoService=a}cupos=[];ngOnInit(){this.cargarReservas()}cargarReservas(){let t=this.authService.getAuthenticatedUserEmail();t?this.aseguradoService.getAseguradoPorCorreo(t).subscribe(e=>{e.id!==void 0?this.cupoService.obtenerCuposPorAsegurado(e.id).subscribe(a=>{let s=a.filter(l=>l.estado==="Ocupado");this.cupos=s.map(l=>x(h({},l),{isDeleting:!1})),console.log("Cupos ocupados obtenidos:",this.cupos)},a=>console.error("Error al obtener cupos:",a)):console.error("El ID del asegurado es undefined.")},e=>console.error("Error al obtener el asegurado:",e)):console.error("No se pudo obtener el correo del asegurado.")}confirmDelete(t){t.isDeleting=!0}cancelDelete(t){t.isDeleting=!1}liberarCupo(t){let e={estado:"Libre"};this.cupoService.quitarCupo(t.id,e).subscribe(a=>{console.log("Cupo liberado exitosamente:",a),t.estado="Libre",t.isDeleting=!1,this.cargarReservas()},a=>{console.error("Error al liberar el cupo:",a),t.isDeleting=!1})}static \u0275fac=function(e){return new(e||r)(b(F),b(D),b(V))};static \u0275cmp=M({type:r,selectors:[["app-mis-reservas"]],standalone:!0,features:[S],decls:5,vars:3,consts:[[3,"value","sortField","sortOrder"],["pTemplate","header"],["pTemplate","body"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","type","button","icon","pi pi-trash","class","p-button-rounded p-button-danger",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-check","class","p-button-rounded p-button-success",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-times","class","p-button-rounded p-button-danger",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],["pButton","","type","button","icon","pi pi-check",1,"p-button-rounded","p-button-success",3,"click"],["pButton","","type","button","icon","pi pi-times",1,"p-button-rounded","p-button-danger",3,"click"]],template:function(e,a){e&1&&(n(0,"h3"),i(1,"Mis Reservas"),o(),n(2,"p-table",0),C(3,j,15,0,"ng-template",1)(4,L,19,13,"ng-template",2),o()),e&2&&(c(2),u("value",a.cupos)("sortField","id")("sortOrder",1))},dependencies:[B,A,w,I,y,k,T,R],styles:["h3[_ngcontent-%COMP%]{text-align:center;color:#3f51b5;font-weight:700;font-size:1.8rem;margin:0 0 20px;border-bottom:2px solid #ddd;padding-bottom:.5rem}.p-table[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:0 auto;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #00000026}.p-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;font-weight:700;text-align:center;padding:12px}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .3s}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f5f5f5}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e3f2fd}.p-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:center;vertical-align:middle}.p-button-danger[_ngcontent-%COMP%], .p-button-success[_ngcontent-%COMP%]{border:none!important;width:36px;height:36px;display:flex;align-items:center;justify-content:center}.p-button-danger[_ngcontent-%COMP%]{background-color:#e53935!important;color:#fff!important}.p-button-danger[_ngcontent-%COMP%]:hover{background-color:#d32f2f!important}.p-button-success[_ngcontent-%COMP%]{background-color:#43a047!important;color:#fff!important}.p-button-success[_ngcontent-%COMP%]:hover{background-color:#388e3c!important}.flex[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:center;align-items:center}.p-button-rounded[_ngcontent-%COMP%]{border-radius:50%!important}"]})};export{v as default};
