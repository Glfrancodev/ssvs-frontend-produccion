import{a as U}from"./chunk-RECFE55V.js";import{a as D,c as V}from"./chunk-HWUH7ABB.js";import"./chunk-JCJIXIGU.js";import{a as A}from"./chunk-U3KGF4RJ.js";import{a as j}from"./chunk-UJ32YO6L.js";import{a as F}from"./chunk-MZW6JDJM.js";import{A as k,H as R,h as w}from"./chunk-5RHHIFSU.js";import"./chunk-W5NNSEVP.js";import"./chunk-4YRY4IP2.js";import{h as y}from"./chunk-V6WZIOIM.js";import{l as O,m as I,r as T}from"./chunk-2HP4KZBQ.js";import{$a as s,Ab as E,Fb as M,Gb as S,Ka as r,La as u,X as x,Ya as d,ea as _,eb as a,fa as C,fb as t,kb as P,nb as v,ob as g,xb as o,yb as p,zb as m}from"./chunk-TOSOZOFE.js";import{g as L}from"./chunk-ODN5LVDJ.js";var N=L(U());V();var $=()=>({"min-width":"50rem","max-width":"100%"});function B(i,n){if(i&1&&(a(0,"div",8)(1,"p")(2,"strong"),o(3,"ID:"),t(),o(4),t(),a(5,"p")(6,"strong"),o(7,"Asegurado:"),t(),o(8),t(),a(9,"p")(10,"strong"),o(11,"Fecha Consulta:"),t(),o(12),t(),a(13,"p")(14,"strong"),o(15,"Motivo:"),t(),o(16),t(),a(17,"p")(18,"strong"),o(19,"Nota:"),t(),o(20),t(),a(21,"p")(22,"strong"),o(23,"M\xE9dico:"),t(),o(24),t(),a(25,"p")(26,"strong"),o(27,"Cupo:"),t(),o(28),t()()),i&2){let e=g();r(4),m(" ",e.consulta.id,""),r(4),E(" ",e.consulta.cupo==null||e.consulta.cupo.asegurado==null||e.consulta.cupo.asegurado.usuario==null?null:e.consulta.cupo.asegurado.usuario.nombre," ",e.consulta.cupo==null||e.consulta.cupo.asegurado==null||e.consulta.cupo.asegurado.usuario==null?null:e.consulta.cupo.asegurado.usuario.apellido,""),r(4),m(" ",e.consulta.fechaConsulta,""),r(4),m(" ",e.consulta.motivoConsulta,""),r(4),m(" ",e.consulta.nota,""),r(4),m(" ",e.consulta.cupo==null||e.consulta.cupo.horario==null||e.consulta.cupo.horario.medicoEspecialidad==null||e.consulta.cupo.horario.medicoEspecialidad.medico==null||e.consulta.cupo.horario.medicoEspecialidad.medico.usuario==null?null:e.consulta.cupo.horario.medicoEspecialidad.medico.usuario.nombre,""),r(4),m(" ",e.consulta.cupo==null?null:e.consulta.cupo.id,"")}}function H(i,n){i&1&&(a(0,"tr")(1,"th"),o(2,"Medicamento"),t(),a(3,"th"),o(4,"Frecuencia"),t(),a(5,"th"),o(6,"Fecha Inicio"),t(),a(7,"th"),o(8,"Fecha Final"),t()())}function K(i,n){if(i&1&&(a(0,"tr")(1,"td"),o(2),t(),a(3,"td"),o(4),t(),a(5,"td"),o(6),t(),a(7,"td"),o(8),t()()),i&2){let e=n.$implicit;r(2),p(e.medicamento),r(2),p(e.frecuencia),r(2),p(e.fechaInicio),r(2),p(e.fechaFinal)}}function W(i,n){if(i&1&&(a(0,"p-table",9),d(1,H,9,0,"ng-template",10)(2,K,9,4,"ng-template",11),t()),i&2){let e=g();s("value",e.recetas)("tableStyle",S(2,$))}}function Y(i,n){i&1&&(a(0,"p"),o(1,"No hay recetas asociadas a esta consulta."),t())}function q(i,n){if(i&1){let e=P();a(0,"div",14)(1,"span"),o(2),t(),a(3,"button",1),v("click",function(){let l=_(e).$implicit,f=g(2);return C(f.descargarArchivo(l.nombre))}),o(4,"Descargar"),t()()}if(i&2){let e=n.$implicit;r(2),p(e.nombre)}}function G(i,n){if(i&1&&(a(0,"div",12),d(1,q,5,1,"div",13),t()),i&2){let e=g();r(),s("ngForOf",e.archivos)}}function J(i,n){i&1&&(a(0,"p"),o(1,"No hay archivos adjuntos para esta consulta."),t())}var b=class i{constructor(n,e,c,l){this.recetaService=n;this.tratamientoService=e;this.consultaService=c;this.route=l}consulta=null;recetas=[];archivos=[];tratamientoId;ngOnInit(){let n=Number(this.route.snapshot.paramMap.get("consultaId"));n&&(this.obtenerDetallesConsulta(n),this.obtenerTratamientoYRecetas(n),this.obtenerArchivosConsulta(n))}obtenerDetallesConsulta(n){this.consultaService.getConsultaPorId(n).subscribe(e=>{this.consulta=e},e=>{console.error("Error al obtener detalles de la consulta:",e)})}obtenerTratamientoYRecetas(n){this.tratamientoService.getTratamientoByConsultaId(n).subscribe(e=>{e.id&&(this.tratamientoId=e.id,this.cargarRecetas(e.id))},e=>{console.error("Error al obtener el tratamiento:",e)})}cargarRecetas(n){this.recetaService.getRecetasByTratamientoId(n).subscribe(e=>{this.recetas=e},e=>{console.error("Error al cargar recetas:",e)})}obtenerArchivosConsulta(n){this.consultaService.getArchivosPorConsulta(n).subscribe(e=>{this.archivos=e.map(c=>({nombre:c.nombre,url:c.url}))},e=>{console.error("Error al cargar archivos:",e)})}descargarArchivo(n){this.consultaService.descargarArchivo(n).subscribe({next:e=>{let c=document.createElement("a"),l=URL.createObjectURL(e);c.href=l,c.download=n,c.click(),URL.revokeObjectURL(l)},error:e=>{console.error("Error al descargar el archivo:",e)}})}exportarPDF(){let n=document.querySelector(".tratamiento-container");n?(0,N.default)(n,{scale:2}).then(e=>{let c=e.toDataURL("image/png"),l=new D("p","mm","a4"),f=l.getImageProperties(c),h=l.internal.pageSize.getWidth(),z=f.height*h/f.width;l.addImage(c,"PNG",0,0,h,z),l.save("detalle-consulta.pdf")}):console.error("Error: no se pudo encontrar el contenido para exportar.")}static \u0275fac=function(e){return new(e||i)(u(A),u(j),u(F),u(y))};static \u0275cmp=x({type:i,selectors:[["app-tratamiento"]],standalone:!0,features:[M],decls:16,vars:5,consts:[[1,"exportar-pdf"],[3,"click"],[1,"tratamiento-container"],["class","consulta-detalle",4,"ngIf"],["dataKey","id",3,"value","tableStyle",4,"ngIf"],[4,"ngIf"],[1,"archivos-container"],["class","archivos-adjuntos",4,"ngIf"],[1,"consulta-detalle"],["dataKey","id",3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],[1,"archivos-adjuntos"],["class","archivo-item",4,"ngFor","ngForOf"],[1,"archivo-item"]],template:function(e,c){e&1&&(a(0,"div",0)(1,"button",1),v("click",function(){return c.exportarPDF()}),o(2,"Exportar como PDF"),t()(),a(3,"div",2)(4,"h3"),o(5,"Detalle de Consulta"),t(),d(6,B,29,8,"div",3),a(7,"h4"),o(8,"Recetas"),t(),d(9,W,3,3,"p-table",4)(10,Y,2,0,"p",5),t(),a(11,"div",6)(12,"h4"),o(13,"Archivos Adjuntos"),t(),d(14,G,2,1,"div",7)(15,J,2,0,"p",5),t()),e&2&&(r(6),s("ngIf",c.consulta),r(3),s("ngIf",c.recetas.length>0),r(),s("ngIf",c.recetas.length===0),r(4),s("ngIf",c.archivos.length>0),r(),s("ngIf",c.archivos.length===0))},dependencies:[R,k,w,T,O,I],styles:[".tratamiento-container[_ngcontent-%COMP%]{max-width:100%;margin:auto;padding:1.5rem;background-color:#f9f9f9;border-radius:12px;box-shadow:0 4px 8px #0000001a}.tratamiento-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .tratamiento-container[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#3f51b5;text-align:center;margin-bottom:1rem}.consulta-detalle[_ngcontent-%COMP%]{margin-bottom:2rem;padding:1rem;background-color:#f0f4ff;border:1px solid #c3dafe;border-radius:8px}.consulta-detalle[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0;font-size:1rem}.consulta-detalle[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#3f51b5}.p-table[_ngcontent-%COMP%]{width:100%;border-radius:8px;overflow:hidden;font-size:1rem;box-shadow:0 4px 8px #0000001a}.p-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;padding:12px;text-align:center;font-weight:700}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .3s}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f7f7f7}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0f7fa}.p-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:center;vertical-align:middle}.archivos-adjuntos[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;justify-content:center;margin-top:1rem}.archivo-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:250px;padding:.5rem;border:1px solid #ccc;border-radius:8px;background-color:#fff;box-shadow:0 2px 4px #0000001a;transition:transform .2s ease,box-shadow .2s ease}.archivo-item[_ngcontent-%COMP%]:hover{transform:scale(1.05);box-shadow:0 4px 8px #00000026}.archivo-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1rem;color:#333;word-break:break-word}.archivo-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;border:none;border-radius:4px;padding:.5rem 1rem;cursor:pointer;font-size:.9rem;transition:background-color .3s ease}.archivo-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2c387e}.exportar-pdf[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none;padding:10px 20px;border-radius:5px;font-weight:700;cursor:pointer;transition:background-color .3s ease}.exportar-pdf[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#388e3c}"]})};export{b as default};
