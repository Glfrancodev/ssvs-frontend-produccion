import{a as re}from"./chunk-LSYYTESY.js";import{a as ae}from"./chunk-TVEXVHUL.js";import{a as K,b as q}from"./chunk-G3JGI5Y7.js";import{a as oe,b as ne}from"./chunk-FXNARXVT.js";import{A as te,B as ie,d as M,f as N,j as F,k as j,l as z,m as G,n as $,s as H,t as J,u as Q,w as X,x as Y,y as Z,z as ee}from"./chunk-F7MBEHRF.js";import{b as V,d as B,e as D,j as L}from"./chunk-24563CTF.js";import"./chunk-4YRY4IP2.js";import"./chunk-EALBQTKK.js";import{k as O,m as A,q as W}from"./chunk-5DWL5JJZ.js";import{$a as b,Ab as s,Bb as w,Cb as y,Eb as c,Fb as u,Gb as m,Hb as T,Ib as I,Jb as R,Na as d,Oa as x,_ as E,a as U,b as S,bc as k,cb as _,ha as g,hb as n,ia as f,ib as r,jb as P,nb as C,qb as h,rb as p}from"./chunk-3RWLLOHT.js";var se=()=>({"min-width":"50rem","max-width":"100%"});function de(t,i){t&1&&(n(0,"tr")(1,"th",20),s(2,"ID"),r(),n(3,"th",21),s(4,"Correo"),r(),n(5,"th",22),s(6,"Nombre"),r(),n(7,"th",22),s(8,"Apellido"),r(),n(9,"th",20),s(10,"Estado"),r(),n(11,"th",22),s(12,"Rol"),r(),n(13,"th",22),s(14,"Acciones"),r()())}function ce(t,i){if(t&1&&s(0),t&2){let e=p().$implicit;y(" ",e.id," ")}}function ue(t,i){if(t&1&&s(0),t&2){let e=p().$implicit;y(" ",e.id," ")}}function me(t,i){if(t&1&&s(0),t&2){let e=p().$implicit;w(e.correo)}}function _e(t,i){if(t&1){let e=C();n(0,"input",31),m("ngModelChange",function(l){g(e);let o=p().$implicit;return u(o.correo,l)||(o.correo=l),f(l)}),r()}if(t&2){let e=p().$implicit;c("ngModel",e.correo)}}function ge(t,i){if(t&1&&s(0),t&2){let e=p().$implicit;w(e.nombre)}}function fe(t,i){if(t&1){let e=C();n(0,"input",31),m("ngModelChange",function(l){g(e);let o=p().$implicit;return u(o.nombre,l)||(o.nombre=l),f(l)}),r()}if(t&2){let e=p().$implicit;c("ngModel",e.nombre)}}function be(t,i){if(t&1&&s(0),t&2){let e=p().$implicit;w(e.apellido)}}function Ce(t,i){if(t&1){let e=C();n(0,"input",31),m("ngModelChange",function(l){g(e);let o=p().$implicit;return u(o.apellido,l)||(o.apellido=l),f(l)}),r()}if(t&2){let e=p().$implicit;c("ngModel",e.apellido)}}function we(t,i){if(t&1&&s(0),t&2){let e=p().$implicit;w(e.estaActivo?"Activo":"Inactivo")}}function he(t,i){if(t&1&&s(0),t&2){let e=p().$implicit;w(e.estaActivo?"Activo":"Inactivo")}}function xe(t,i){if(t&1&&s(0),t&2){let e=p().$implicit;w(e.rol==null?null:e.rol.nombre)}}function Me(t,i){if(t&1){let e=C();n(0,"p-dropdown",32),m("ngModelChange",function(l){g(e);let o=p().$implicit;return u(o.rol.id,l)||(o.rol.id=l),f(l)}),r()}if(t&2){let e=p().$implicit,a=p();_("options",a.roles),c("ngModel",e.rol.id)}}function Ue(t,i){if(t&1){let e=C();n(0,"button",33),h("click",function(){g(e);let l=p().$implicit,o=p();return f(o.onRowEditInit(l))}),r()}}function ye(t,i){if(t&1){let e=C();n(0,"button",34),h("click",function(){g(e);let l=p().$implicit,o=p();return f(o.toggleEstadoUsuario(l))}),r()}if(t&2){let e=p().$implicit;_("ngClass",e.estaActivo?"p-button-danger":"p-button-success")}}function ve(t,i){if(t&1){let e=C();n(0,"button",35),h("click",function(){g(e);let l=p().$implicit,o=p();return f(o.onRowEditSave(l))}),r()}}function Se(t,i){if(t&1){let e=C();n(0,"button",36),h("click",function(){g(e);let l=p(),o=l.$implicit,le=l.rowIndex,pe=p();return f(pe.onRowEditCancel(o,le))}),r()}}function Ee(t,i){if(t&1&&(n(0,"tr",23)(1,"td")(2,"p-cellEditor"),b(3,ce,1,1,"ng-template",24)(4,ue,1,1,"ng-template",25),r()(),n(5,"td")(6,"p-cellEditor"),b(7,me,1,1,"ng-template",24)(8,_e,1,1,"ng-template",25),r()(),n(9,"td")(10,"p-cellEditor"),b(11,ge,1,1,"ng-template",24)(12,fe,1,1,"ng-template",25),r()(),n(13,"td")(14,"p-cellEditor"),b(15,be,1,1,"ng-template",24)(16,Ce,1,1,"ng-template",25),r()(),n(17,"td")(18,"p-cellEditor"),b(19,we,1,1,"ng-template",24)(20,he,1,1,"ng-template",25),r()(),n(21,"td")(22,"p-cellEditor"),b(23,xe,1,1,"ng-template",24)(24,Me,1,2,"ng-template",25),r()(),n(25,"td")(26,"div",26),b(27,Ue,1,0,"button",27)(28,ye,1,1,"button",28)(29,ve,1,0,"button",29)(30,Se,1,0,"button",30),r()()()),t&2){let e=i.$implicit,a=i.editing;_("pEditableRow",e),d(27),_("ngIf",!a),d(),_("ngIf",!a),d(),_("ngIf",a),d(),_("ngIf",a)}}var v=class t{constructor(i,e,a,l){this.usuarioService=i;this.rolService=e;this.messageService=a;this.cdr=l}usuarios=[];roles=[];editedUsuarios={};estadoOptions=[{label:"Activo",value:!0},{label:"Inactivo",value:!1}];newUsuario={ci:"",correo:"",contrasena:"",nombre:"",apellido:"",estaActivo:!0,rol:{id:0,nombre:""}};ngOnInit(){this.getAllUsuarios(),this.getAllRoles()}getAllUsuarios(){this.usuarioService.getUsuarios().subscribe(i=>{this.usuarios=i,this.sortUsuarios()})}getAllRoles(){this.rolService.getRoles().subscribe(i=>{this.roles=i})}sortUsuarios(){this.usuarios.sort((i,e)=>(i.id||0)-(e.id||0))}onRowEditInit(i){this.editedUsuarios[i.id]=U({},i),this.messageService.add({severity:"info",summary:"Edici\xF3n",detail:"Editando usuario"})}onRowEditSave(i){this.usuarioService.updateUsuario(i).subscribe(()=>{delete this.editedUsuarios[i.id],this.messageService.add({severity:"success",summary:"Guardado",detail:"Usuario actualizado"}),this.getAllUsuarios()})}onRowEditCancel(i,e){this.usuarios[e]=this.editedUsuarios[i.id]||i,delete this.editedUsuarios[i.id],this.messageService.add({severity:"info",summary:"Cancelado",detail:"Edici\xF3n cancelada"})}toggleEstadoUsuario(i){let e=S(U({},i),{estaActivo:!i.estaActivo});this.usuarioService.updateUsuario(e).subscribe(()=>{i.estaActivo=!i.estaActivo,this.sortUsuarios(),this.messageService.add({severity:"success",summary:i.estaActivo?"Activado":"Desactivado",detail:`Usuario ${i.estaActivo?"activado":"desactivado"} correctamente`})})}addUsuario(){this.usuarioService.createUsuario(this.newUsuario).subscribe(i=>{this.getAllUsuarios(),this.messageService.add({severity:"success",summary:"Usuario Agregado",detail:"Nuevo usuario creado correctamente"}),this.newUsuario={ci:"",correo:"",contrasena:"",nombre:"",apellido:"",estaActivo:!1,rol:{id:0,nombre:""}}})}static \u0275fac=function(e){return new(e||t)(x(re),x(ae),x(M),x(k))};static \u0275cmp=E({type:t,selectors:[["app-usuario"]],standalone:!0,features:[T([M]),I],decls:34,vars:10,consts:[[1,"usuario-list-container"],[1,"add-usuario-form"],[2,"font-weight","bold"],[1,"form-field"],["for","ci"],["id","ci","type","text","pInputText","","placeholder","Ingrese CI",3,"ngModelChange","ngModel"],["for","correo"],["id","correo","type","email","pInputText","","placeholder","Ingrese Correo",3,"ngModelChange","ngModel"],["for","contrasena"],["id","contrasena","type","password","pInputText","","placeholder","Ingrese Contrase\xF1a",3,"ngModelChange","ngModel"],["for","nombre"],["id","nombre","type","text","pInputText","","placeholder","Ingrese Nombre",3,"ngModelChange","ngModel"],["for","apellido"],["id","apellido","type","text","pInputText","","placeholder","Ingrese Apellido",3,"ngModelChange","ngModel"],["for","rol"],["id","rol","optionLabel","nombre","optionValue","id","placeholder","Seleccione Rol",3,"ngModelChange","options","ngModel"],["label","A\xF1adir Usuario","icon","pi pi-plus","styleClass","p-button-raised p-button-success",3,"click"],["dataKey","id","editMode","row",3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],[2,"width","10%"],[2,"width","20%"],[2,"width","15%"],[3,"pEditableRow"],["pTemplate","output"],["pTemplate","input"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","pi pi-pencil","class","p-button-rounded action-button","style","background-color: #ffffff; color: #007bff; border: none; width: 2rem; height: 2rem;",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-ban","class","p-button-rounded action-button",3,"ngClass","click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","class","p-button-rounded action-button","style","background-color: #ffffff; color: #28a745; border: none; width: 2rem; height: 2rem; margin-right: 0.3rem;",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","class","p-button-rounded action-button","style","background-color: #ffffff; color: #dc3545; border: none; width: 2rem; height: 2rem;",3,"click",4,"ngIf"],["pInputText","","type","text",1,"input-field",3,"ngModelChange","ngModel"],["optionLabel","nombre","optionValue","id","placeholder","Seleccione rol",1,"input-dropdown",3,"ngModelChange","options","ngModel"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","pi pi-pencil",1,"p-button-rounded","action-button",2,"background-color","#ffffff","color","#007bff","border","none","width","2rem","height","2rem",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-ban",1,"p-button-rounded","action-button",3,"click","ngClass"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check",1,"p-button-rounded","action-button",2,"background-color","#ffffff","color","#28a745","border","none","width","2rem","height","2rem","margin-right","0.3rem",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times",1,"p-button-rounded","action-button",2,"background-color","#ffffff","color","#dc3545","border","none","width","2rem","height","2rem",3,"click"]],template:function(e,a){e&1&&(P(0,"p-toast"),n(1,"div",0)(2,"div",1)(3,"h3",2),s(4,"A\xF1adir Nuevo Usuario"),r(),n(5,"div",3)(6,"label",4),s(7,"CI"),r(),n(8,"input",5),m("ngModelChange",function(o){return u(a.newUsuario.ci,o)||(a.newUsuario.ci=o),o}),r()(),n(9,"div",3)(10,"label",6),s(11,"Correo"),r(),n(12,"input",7),m("ngModelChange",function(o){return u(a.newUsuario.correo,o)||(a.newUsuario.correo=o),o}),r()(),n(13,"div",3)(14,"label",8),s(15,"Contrase\xF1a"),r(),n(16,"input",9),m("ngModelChange",function(o){return u(a.newUsuario.contrasena,o)||(a.newUsuario.contrasena=o),o}),r()(),n(17,"div",3)(18,"label",10),s(19,"Nombre"),r(),n(20,"input",11),m("ngModelChange",function(o){return u(a.newUsuario.nombre,o)||(a.newUsuario.nombre=o),o}),r()(),n(21,"div",3)(22,"label",12),s(23,"Apellido"),r(),n(24,"input",13),m("ngModelChange",function(o){return u(a.newUsuario.apellido,o)||(a.newUsuario.apellido=o),o}),r()(),n(25,"div",3)(26,"label",14),s(27,"Rol"),r(),n(28,"p-dropdown",15),m("ngModelChange",function(o){return u(a.newUsuario.rol.id,o)||(a.newUsuario.rol.id=o),o}),r()(),n(29,"div",3)(30,"p-button",16),h("click",function(){return a.addUsuario()}),r()()(),n(31,"p-table",17),b(32,de,15,0,"ng-template",18)(33,Ee,31,5,"ng-template",19),r()()),e&2&&(d(8),c("ngModel",a.newUsuario.ci),d(4),c("ngModel",a.newUsuario.correo),d(4),c("ngModel",a.newUsuario.contrasena),d(4),c("ngModel",a.newUsuario.nombre),d(4),c("ngModel",a.newUsuario.apellido),d(4),_("options",a.roles),c("ngModel",a.newUsuario.rol.id),d(3),_("value",a.usuarios)("tableStyle",R(9,se)))},dependencies:[ne,oe,N,ie,Q,te,X,Y,Z,ee,W,O,A,L,V,B,D,$,z,G,j,F,q,K,J,H],styles:[".usuario-list-container[_ngcontent-%COMP%]{max-width:100%;margin:auto;overflow-x:auto}.add-usuario-form[_ngcontent-%COMP%]{padding:1.5rem;border:1px solid #ddd;border-radius:8px;margin-bottom:2rem;display:grid;grid-template-columns:1fr 1fr;gap:1rem;box-shadow:0 2px 8px #00000026}.add-usuario-form[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{grid-column:1 / -1;margin:0;font-size:1.8rem;color:#3f51b5;text-align:center;border-bottom:2px solid #ddd;padding-bottom:.5rem}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;color:#555;margin-bottom:.2rem}.form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .input-dropdown[_ngcontent-%COMP%]{width:100%;padding:.6rem;border-radius:6px;border:1px solid #ddd;box-shadow:inset 0 1px 2px #0000001a;transition:border-color .3s ease}.input-dropdown[_ngcontent-%COMP%]{padding:.6rem;font-size:1rem;background-color:#fff}.input-dropdown[_ngcontent-%COMP%]:hover, .input-dropdown[_ngcontent-%COMP%]:focus{border-color:#3f51b5}.p-button-success[_ngcontent-%COMP%]{width:100%;height:3rem;font-size:1rem;border-radius:8px;background-color:#3f51b5!important;border:none;color:#fff!important;transition:background-color .3s ease}.p-button-success[_ngcontent-%COMP%]:hover{background-color:#2c3e9e!important}.p-table[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:0 auto;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #00000026}.p-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;font-weight:700;text-align:center;padding:12px}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f9f9f9}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e3f2fd}.p-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:center;vertical-align:middle;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.p-cellEditor[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .p-cellEditor[_ngcontent-%COMP%]   .p-dropdown[_ngcontent-%COMP%]{width:100%!important;max-width:150px;box-sizing:border-box}.action-button[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;display:flex;align-items:center;justify-content:center;border-radius:50%;border:none!important}.p-button-danger[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border-radius:50%;color:#d32f2f!important}.p-button-danger[_ngcontent-%COMP%]:hover{background-color:#d32f2f!important;color:#fff!important}.p-button-success[_ngcontent-%COMP%]{background-color:#43a047!important;color:#fff!important}.p-button-success[_ngcontent-%COMP%]:hover{background-color:#388e3c!important}.p-button-rounded[_ngcontent-%COMP%]{border-radius:50%!important}"]})};export{v as default};
