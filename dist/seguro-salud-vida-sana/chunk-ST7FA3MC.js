import{a as ne}from"./chunk-MQGP7DR4.js";import{a as re}from"./chunk-TVEXVHUL.js";import{a as J,b as Q}from"./chunk-BNUNU2GP.js";import{a as oe,b as ie}from"./chunk-O3KWYK2S.js";import{B as te,d as P,f as z,j as $,k as L,l as G,m as K,n as q,s as X,t as Y,u as Z,v as ee}from"./chunk-RDO4C5ZH.js";import"./chunk-4YRY4IP2.js";import{b as H,d as V,e as B,f as j,g as U,j as W}from"./chunk-24563CTF.js";import{a as N,b as D,o as F}from"./chunk-EALBQTKK.js";import{m as T,q as k}from"./chunk-5DWL5JJZ.js";import{$a as f,Ab as s,Bb as p,Eb as C,Fb as S,Gb as M,Hb as O,Ib as E,Jb as A,Na as a,Oa as c,Q as I,V as _,_ as y,cb as u,ha as g,hb as i,ia as b,ib as o,jb as w,nb as x,qb as h,rb as d}from"./chunk-3RWLLOHT.js";var v=class r{constructor(t,e){this.http=t;this.authService=e}apiUrl="https://ssvs-backend-produccion-production.up.railway.app/api/rol-permiso";getAuthHeaders(){return new N({"Content-Type":"application/json",Authorization:`Bearer ${this.authService.getToken()}`})}getRolPermisos(){return this.http.get(this.apiUrl,{headers:this.getAuthHeaders()})}getRolPermisoById(t){return this.http.get(`${this.apiUrl}/${t}`,{headers:this.getAuthHeaders()})}createRolPermiso(t){return this.http.post(this.apiUrl,t,{headers:this.getAuthHeaders()})}updateRolPermiso(t){return this.http.put(`${this.apiUrl}/${t.id}`,t,{headers:this.getAuthHeaders()})}deleteRolPermiso(t){return this.http.delete(`${this.apiUrl}/${t}`,{headers:this.getAuthHeaders()})}static \u0275fac=function(e){return new(e||r)(_(D),_(F))};static \u0275prov=I({token:r,factory:r.\u0275fac,providedIn:"root"})};var ae=()=>({"min-width":"50rem"});function me(r,t){if(r&1){let e=x();i(0,"div",8)(1,"h3"),s(2,"Informaci\xF3n del Rol"),o(),i(3,"div",1)(4,"label"),s(5,"ID:"),o(),i(6,"span"),s(7),o()(),i(8,"div",1)(9,"label"),s(10,"Nombre:"),o(),i(11,"span"),s(12),o()(),i(13,"div",9)(14,"label"),s(15,"Asignar Permiso"),o(),i(16,"p-dropdown",10),M("ngModelChange",function(l){g(e);let m=d();return S(m.selectedPermisoId,l)||(m.selectedPermisoId=l),b(l)}),o()(),i(17,"div",11)(18,"p-button",12),h("click",function(){g(e);let l=d();return b(l.assignPermiso())}),o()()()}if(r&2){let e=d();a(7),p(e.rol.id),a(5),p(e.rol.nombre),a(4),u("options",e.permisosNoAsignados),C("ngModel",e.selectedPermisoId)}}function de(r,t){r&1&&(i(0,"tr")(1,"th",16),s(2,"ID Permiso"),o(),i(3,"th",17),s(4,"Nombre Permiso"),o(),i(5,"th",18),s(6,"Descripci\xF3n"),o(),i(7,"th",19),s(8,"Acciones"),o()())}function pe(r,t){if(r&1){let e=x();i(0,"tr")(1,"td"),s(2),o(),i(3,"td"),s(4),o(),i(5,"td"),s(6),o(),i(7,"td")(8,"button",20),h("click",function(){let l=g(e).$implicit,m=d(2);return b(m.deleteRolPermiso(l.id))}),o()()()}if(r&2){let e=t.$implicit;a(2),p(e.permiso.id),a(2),p(e.permiso.nombre),a(2),p(e.permiso.descripcion)}}function ce(r,t){if(r&1&&(i(0,"p-table",13),f(1,de,9,0,"ng-template",14)(2,pe,9,3,"ng-template",15),o()),r&2){let e=d();u("value",e.rolPermisos)("tableStyle",A(4,ae))("sortField",e.sortField)("sortOrder",e.sortOrder)}}var R=class r{constructor(t,e,n,l){this.rolService=t;this.permisoService=e;this.rolPermisoService=n;this.messageService=l}rolId=0;rol=null;rolPermisos=[];permisosNoAsignados=[];selectedPermisoId=null;sortField="permiso.id";sortOrder=1;ngOnInit(){}buscarRol(){this.rolId>0?this.rolService.getRolById(this.rolId).subscribe(t=>{t?(this.rol=t,this.buscarRolPermisos()):(this.messageService.add({severity:"warn",summary:"Advertencia",detail:"Ingrese un ID de rol v\xE1lido"}),this.rol=null,this.rolPermisos=[],this.permisosNoAsignados=[])},t=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al buscar el rol"})}):this.messageService.add({severity:"warn",summary:"Advertencia",detail:"Ingrese un ID de rol v\xE1lido"})}buscarRolPermisos(){this.rolPermisoService.getRolPermisos().subscribe(t=>{this.rolPermisos=t.filter(e=>e.rol.id===this.rolId).sort((e,n)=>(e.permiso.id||0)-(n.permiso.id||0)),this.buscarPermisosNoAsignados()},t=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error al obtener permisos del rol"})})}buscarPermisosNoAsignados(){this.permisoService.getPermisos().subscribe(t=>{let e=this.rolPermisos.map(n=>n.permiso.id);this.permisosNoAsignados=t.filter(n=>!e.includes(n.id))})}assignPermiso(){if(this.selectedPermisoId){let t={rol:this.rol,permiso:{id:this.selectedPermisoId}};this.rolPermisoService.createRolPermiso(t).subscribe(()=>{this.buscarRolPermisos(),this.buscarPermisosNoAsignados(),this.selectedPermisoId=null,this.messageService.add({severity:"success",summary:"Asignado",detail:"Permiso asignado correctamente"})},()=>{this.messageService.add({severity:"error",summary:"Error",detail:"No se pudo asignar el permiso"})})}else this.messageService.add({severity:"error",summary:"Error",detail:"Seleccione un permiso para asignar"})}deleteRolPermiso(t){this.rolPermisoService.deleteRolPermiso(t).subscribe(()=>{this.rolPermisos=this.rolPermisos.filter(e=>e.id!==t),this.buscarPermisosNoAsignados(),this.messageService.add({severity:"success",summary:"Eliminado",detail:"Permiso del rol eliminado correctamente"})})}static \u0275fac=function(e){return new(e||r)(c(re),c(ne),c(v),c(P))};static \u0275cmp=y({type:r,selectors:[["app-rol-permiso"]],standalone:!0,features:[O([P]),E],decls:12,vars:3,consts:[[1,"form-container"],[1,"form-field"],["for","rolId"],["id","rolId","type","number","pInputText","","placeholder","Ingrese el ID del rol","min","0",3,"ngModelChange","ngModel"],[1,"form-field",2,"text-align","center"],["icon","pi pi-search","label","Buscar","styleClass","p-button-raised p-button-info",3,"click"],["style","margin-top: 20px; border-top: 1px solid #ddd; padding-top: 20px;",4,"ngIf"],["dataKey","id","editMode","row",3,"value","tableStyle","sortField","sortOrder",4,"ngIf"],[2,"margin-top","20px","border-top","1px solid #ddd","padding-top","20px"],[1,"form-field",2,"margin-top","20px"],["optionLabel","nombre","optionValue","id","placeholder","Seleccione un permiso",3,"ngModelChange","options","ngModel"],[1,"form-field",2,"text-align","center","margin-top","10px"],["icon","pi pi-plus","label","Asignar","styleClass","p-button-raised p-button-success",3,"click"],["dataKey","id","editMode","row",3,"value","tableStyle","sortField","sortOrder"],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","permiso.id",2,"width","10%"],[2,"width","30%"],[2,"width","40%"],[2,"width","20%"],["pButton","","pRipple","","type","button","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"]],template:function(e,n){e&1&&(w(0,"p-toast"),i(1,"div",0)(2,"h3"),s(3,"Buscar Rol por ID"),o(),i(4,"div",1)(5,"label",2),s(6,"ID del Rol"),o(),i(7,"input",3),M("ngModelChange",function(m){return S(n.rolId,m)||(n.rolId=m),m}),o()(),i(8,"div",4)(9,"p-button",5),h("click",function(){return n.buscarRol()}),o()(),f(10,me,19,4,"div",6),o(),f(11,ce,3,5,"p-table",7)),e&2&&(a(7),C("ngModel",n.rolId),a(3),u("ngIf",n.rol),a(),u("ngIf",n.rolPermisos.length>0))},dependencies:[ie,oe,z,te,Z,ee,k,T,W,H,j,V,U,B,q,G,K,L,$,Q,J,Y,X],styles:[".form-container[_ngcontent-%COMP%]{padding:1.5rem;border:1px solid #ddd;border-radius:12px;background-color:#f9f9f9;box-shadow:0 4px 8px #0000001a;margin-bottom:1.5rem;max-width:100%;margin:auto}.form-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#3f51b5;text-align:center;margin:0;margin-bottom:1rem;border-bottom:2px solid #ddd;padding-bottom:.5rem}.form-field[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;flex-direction:column}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333;margin-bottom:.25rem}input[pInputText][_ngcontent-%COMP%], .p-dropdown[_ngcontent-%COMP%]{width:100%;padding:.5rem;border-radius:6px;border:1px solid #ddd;background-color:#fff;font-size:.95rem;box-shadow:inset 0 1px 3px #0000001a;transition:border-color .3s ease}input[pInputText][_ngcontent-%COMP%]:focus, .p-dropdown[_ngcontent-%COMP%]:focus{outline:none;border-color:#3f51b5;box-shadow:0 0 4px #3f51b54d}.p-button-info[_ngcontent-%COMP%], .p-button-success[_ngcontent-%COMP%]{font-size:1rem;border-radius:8px;width:100%;max-width:150px;margin:auto;box-shadow:0 2px 6px #00000026}.p-button-info[_ngcontent-%COMP%]:hover{background-color:#007bb5!important}.p-button-success[_ngcontent-%COMP%]:hover{background-color:#388e3c!important}.p-table[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:auto;border-radius:8px;overflow:hidden;box-shadow:0 4px 8px #0000001a;font-size:.95rem}.p-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;font-weight:700;text-align:center;padding:12px}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .3s}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f7f7f7}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0f7fa}.p-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:center;vertical-align:middle}.p-button-rounded.p-button-danger[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border-radius:50%;color:#d32f2f!important}.p-button-rounded.p-button-danger[_ngcontent-%COMP%]:hover{background-color:#d32f2f!important;color:#fff!important}"]})};export{R as default};
