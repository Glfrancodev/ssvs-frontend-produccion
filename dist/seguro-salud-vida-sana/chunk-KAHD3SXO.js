import{a as oe}from"./chunk-GB72KSVT.js";import{a as ie}from"./chunk-LSYYTESY.js";import{a as ee,b as te}from"./chunk-O3KWYK2S.js";import{A as Z,B as $,d as x,f as F,j as W,k as U,l as L,n as j,p as z,q as G,s as H,t as K,u as q,w as J,x as Q,y as X,z as Y}from"./chunk-RDO4C5ZH.js";import"./chunk-4YRY4IP2.js";import{b as O,d as N,e as V,i as B,j as D}from"./chunk-24563CTF.js";import"./chunk-EALBQTKK.js";import{m as P,q as R}from"./chunk-5DWL5JJZ.js";import{$a as S,Ab as d,Bb as f,Db as E,Eb as b,Fb as h,Gb as C,Hb as T,Ib as I,Jb as k,Na as u,Oa as v,_ as y,a as A,cb as p,ha as c,hb as i,ia as m,ib as o,jb as M,nb as g,qb as _,rb as l}from"./chunk-3RWLLOHT.js";var ae=()=>({"min-width":"50rem","max-width":"100%"});function de(a,e){a&1&&(i(0,"tr")(1,"th",16),d(2,"ID"),o(),i(3,"th",17),d(4,"Tipo de Sangre"),o(),i(5,"th",16),d(6,"Sexo"),o(),i(7,"th",18),d(8,"Fecha de Nacimiento"),o(),i(9,"th",19),d(10,"Nombre Completo"),o(),i(11,"th",20),d(12,"Id Historia"),o(),i(13,"th",16),d(14,"Acci\xF3n"),o()())}function se(a,e){if(a&1&&d(0),a&2){let t=l().$implicit;f(t.tipoSangre)}}function ue(a,e){if(a&1){let t=g();i(0,"input",29),C("ngModelChange",function(s){c(t);let r=l().$implicit;return h(r.tipoSangre,s)||(r.tipoSangre=s),m(s)}),o()}if(a&2){let t=l().$implicit;b("ngModel",t.tipoSangre)}}function le(a,e){if(a&1){let t=g();i(0,"button",30),_("click",function(){c(t);let s=l().$implicit,r=l();return m(r.onRowEditInit(s))}),o()}}function pe(a,e){if(a&1){let t=g();i(0,"button",31),_("click",function(){c(t);let s=l().$implicit,r=l();return m(r.onRowEditSave(s))}),o()}}function ce(a,e){if(a&1){let t=g();i(0,"button",32),_("click",function(){c(t);let s=l(),r=s.$implicit,ne=s.rowIndex,re=l();return m(re.onRowEditCancel(r,ne))}),o()}}function me(a,e){if(a&1){let t=g();i(0,"button",33),_("click",function(){c(t);let s=l().$implicit,r=l();return m(r.deleteAsegurado(s.id))}),o()}}function ge(a,e){if(a&1&&(i(0,"tr",21)(1,"td"),d(2),o(),i(3,"td")(4,"p-cellEditor"),S(5,se,1,1,"ng-template",22)(6,ue,1,1,"ng-template",23),o()(),i(7,"td"),d(8),o(),i(9,"td"),d(10),o(),i(11,"td"),d(12),o(),i(13,"td"),d(14),o(),i(15,"td")(16,"div",24),S(17,le,1,0,"button",25)(18,pe,1,0,"button",26)(19,ce,1,0,"button",27)(20,me,1,0,"button",28),o()()()),a&2){let t=e.$implicit,n=e.editing;p("pEditableRow",t),u(2),f(t.id),u(6),f(t.sexo),u(2),f(t.fechaNacimiento),u(2),E("",t.usuario==null?null:t.usuario.nombre," ",t.usuario==null?null:t.usuario.apellido,""),u(2),f(t.historiaClinica.id),u(3),p("ngIf",!n),u(),p("ngIf",n),u(),p("ngIf",n),u(),p("ngIf",!n)}}var w=class a{constructor(e,t,n){this.aseguradoService=e;this.usuarioService=t;this.messageService=n}asegurados=[];usuariosDisponibles=[];nuevoAsegurado={tipoSangre:"",sexo:"",fechaNacimiento:"",usuario:{id:0,ci:"",correo:"",contrasena:"",nombre:"",apellido:"",estaActivo:!0,rol:void 0},historiaClinica:{id:0}};editedAsegurados={};sortField="id";sortOrder=1;ngOnInit(){this.getAsegurados(),this.getUsuariosDisponibles()}getAsegurados(){this.aseguradoService.getAsegurados().subscribe(e=>this.asegurados=e,e=>this.messageService.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los asegurados"}))}getUsuariosDisponibles(){this.usuarioService.getUsuariosSinAseguradoByRol(2).subscribe(e=>this.usuariosDisponibles=e,e=>this.messageService.add({severity:"error",summary:"Error",detail:"No se pudieron cargar los usuarios disponibles"}))}addAsegurado(){this.aseguradoService.createAsegurado(this.nuevoAsegurado).subscribe(e=>{this.getAsegurados(),this.asegurados.push(e),this.messageService.add({severity:"success",summary:"A\xF1adido",detail:"Asegurado a\xF1adido correctamente"}),this.resetNuevoAsegurado(),this.getUsuariosDisponibles()},e=>this.messageService.add({severity:"error",summary:"Error",detail:"No se pudo a\xF1adir el asegurado"}))}resetNuevoAsegurado(){this.nuevoAsegurado={tipoSangre:"",sexo:"",fechaNacimiento:"",usuario:{id:0,ci:"",correo:"",contrasena:"",nombre:"",apellido:"",estaActivo:!0,rol:void 0},historiaClinica:{id:0}}}deleteAsegurado(e){this.aseguradoService.deleteAsegurado(e).subscribe(()=>{this.asegurados=this.asegurados.filter(t=>t.id!==e),this.messageService.add({severity:"success",summary:"Eliminado",detail:"Asegurado eliminado correctamente"}),this.getUsuariosDisponibles()},t=>this.messageService.add({severity:"error",summary:"Error",detail:"No se pudo eliminar el asegurado"}))}onRowEditInit(e){this.editedAsegurados[e.id]=A({},e),this.messageService.add({severity:"info",summary:"Edici\xF3n",detail:"Editando tipo de sangre"})}onRowEditSave(e){this.aseguradoService.updateAsegurado(e).subscribe(()=>{delete this.editedAsegurados[e.id],this.messageService.add({severity:"success",summary:"Guardado",detail:"Tipo de sangre actualizado"})})}onRowEditCancel(e,t){this.asegurados[t]=this.editedAsegurados[e.id]||e,delete this.editedAsegurados[e.id],this.messageService.add({severity:"info",summary:"Cancelado",detail:"Edici\xF3n cancelada"})}static \u0275fac=function(t){return new(t||a)(v(oe),v(ie),v(x))};static \u0275cmp=y({type:a,selectors:[["app-asegurado"]],standalone:!0,features:[T([x]),I],decls:26,vars:10,consts:[[1,"add-asegurado-form"],[1,"form-field"],["for","tipoSangre"],["id","tipoSangre","pInputText","","placeholder","Ingrese el tipo de sangre",1,"input-field",3,"ngModelChange","ngModel"],["for","sexo"],["id","sexo","pInputText","","placeholder","Ingrese el sexo","maxlength","1",1,"input-field",3,"ngModelChange","ngModel"],["for","fechaNacimiento"],["dateFormat","yy-mm-dd",1,"input-calendar",3,"ngModelChange","ngModel"],["for","usuario"],["id","usuario","optionLabel","correo","optionValue","id","placeholder","Seleccione un usuario",1,"input-dropdown",3,"ngModelChange","options","ngModel"],[1,"form-field","button-container"],["pButton","","label","A\xF1adir Asegurado",1,"p-button-success",3,"click"],[1,"asegurado-list-container",2,"margin-top","2rem"],["dataKey","id","editMode","row",3,"value","tableStyle","sortField","sortOrder"],["pTemplate","header"],["pTemplate","body"],[2,"width","10%"],[2,"width","15%"],[2,"width","20%"],[2,"width","30%"],[2,"width","5%"],[3,"pEditableRow"],["pTemplate","output"],["pTemplate","input"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","pi pi-pencil","class","p-button-rounded",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","class","p-button-rounded p-button-success",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","class","p-button-rounded p-button-danger",3,"click",4,"ngIf"],["pButton","","icon","pi pi-trash","class","p-button-rounded p-button-danger",3,"click",4,"ngIf"],["pInputText","",1,"input-field",3,"ngModelChange","ngModel"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","pi pi-pencil",1,"p-button-rounded",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check",1,"p-button-rounded","p-button-success",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times",1,"p-button-rounded","p-button-danger",3,"click"],["pButton","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"]],template:function(t,n){t&1&&(M(0,"p-toast"),i(1,"div",0)(2,"h3"),d(3,"A\xF1adir Asegurado"),o(),i(4,"div",1)(5,"label",2),d(6,"Tipo de Sangre"),o(),i(7,"input",3),C("ngModelChange",function(r){return h(n.nuevoAsegurado.tipoSangre,r)||(n.nuevoAsegurado.tipoSangre=r),r}),o()(),i(8,"div",1)(9,"label",4),d(10,"Sexo"),o(),i(11,"input",5),C("ngModelChange",function(r){return h(n.nuevoAsegurado.sexo,r)||(n.nuevoAsegurado.sexo=r),r}),o()(),i(12,"div",1)(13,"label",6),d(14,"Fecha de Nacimiento"),o(),i(15,"p-calendar",7),C("ngModelChange",function(r){return h(n.nuevoAsegurado.fechaNacimiento,r)||(n.nuevoAsegurado.fechaNacimiento=r),r}),o()(),i(16,"div",1)(17,"label",8),d(18,"Usuario"),o(),i(19,"p-dropdown",9),C("ngModelChange",function(r){return h(n.nuevoAsegurado.usuario.id,r)||(n.nuevoAsegurado.usuario.id=r),r}),o()(),i(20,"div",10)(21,"button",11),_("click",function(){return n.addAsegurado()}),o()()(),i(22,"div",12)(23,"p-table",13),S(24,de,15,0,"ng-template",14)(25,ge,21,11,"ng-template",15),o()()),t&2&&(u(7),b("ngModel",n.nuevoAsegurado.tipoSangre),u(4),b("ngModel",n.nuevoAsegurado.sexo),u(4),b("ngModel",n.nuevoAsegurado.fechaNacimiento),u(4),p("options",n.usuariosDisponibles),b("ngModel",n.nuevoAsegurado.usuario.id),u(4),p("value",n.asegurados)("tableStyle",k(9,ae))("sortField",n.sortField)("sortOrder",n.sortOrder))},dependencies:[R,P,D,O,N,B,V,$,q,F,Z,J,Q,X,Y,te,ee,K,H,G,z,L,j,U,W],styles:[".asegurado-list-container[_ngcontent-%COMP%]{max-width:100%;margin:auto;overflow-x:auto}.add-asegurado-form[_ngcontent-%COMP%]{padding:1.5rem;border:1px solid #dcdcdc;border-radius:12px;background-color:#f9f9f9;box-shadow:0 4px 8px #0000001a;margin-bottom:1.5rem;display:grid;grid-template-columns:1fr 1fr;gap:1rem}.add-asegurado-form[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{grid-column:1 / -1;font-size:1.8rem;font-weight:700;color:#3f51b5;text-align:center;margin:0;margin-bottom:1rem;border-bottom:2px solid #ddd;padding-bottom:.5rem}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333;margin-bottom:.25rem}.input-field[_ngcontent-%COMP%], .input-dropdown[_ngcontent-%COMP%], .input-calendar[_ngcontent-%COMP%]{width:100%;padding:.5rem;border-radius:6px;border:1px solid #ddd;background-color:#fff;font-size:.95rem;box-shadow:inset 0 1px 3px #0000001a}.input-dropdown[_ngcontent-%COMP%]:focus, .input-field[_ngcontent-%COMP%]:focus, .input-calendar[_ngcontent-%COMP%]:focus{outline:none;border-color:#3f51b5;box-shadow:0 0 4px #3f51b54d}.button-container[_ngcontent-%COMP%]{grid-column:1 / -1;display:flex;justify-content:center}.p-button-success[_ngcontent-%COMP%]{background-color:#4caf50!important;color:#fff!important;width:40%;font-size:1rem;border-radius:8px;padding:.75rem 0;border:none!important;font-weight:700;transition:background-color .3s ease}.p-button-rounded[_ngcontent-%COMP%]{border-radius:50%!important}.p-button-danger[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border-radius:50%;color:#d32f2f!important}.p-button-danger[_ngcontent-%COMP%]:hover{background-color:#d32f2f!important;color:#fff!important}.p-button-success[_ngcontent-%COMP%]{background-color:#43a047!important;color:#fff!important}.p-button-success[_ngcontent-%COMP%]:hover{background-color:#388e3c!important}"]})};export{w as default};
