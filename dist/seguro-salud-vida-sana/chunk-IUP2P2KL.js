import{a as F}from"./chunk-NY3PXWMS.js";import{a as V}from"./chunk-GB72KSVT.js";import{B,f as w,l as R,n as T,u as A}from"./chunk-F7MBEHRF.js";import"./chunk-24563CTF.js";import"./chunk-4YRY4IP2.js";import{o as D}from"./chunk-EALBQTKK.js";import{m as y,p as k,q as I}from"./chunk-5DWL5JJZ.js";import{$a as C,Ab as o,Bb as d,Db as E,Ib as S,Na as l,Oa as b,Sb as P,Tb as O,_ as M,a as h,b as x,cb as u,ha as m,hb as n,ia as g,ib as i,nb as _,qb as f,rb as s}from"./chunk-3RWLLOHT.js";function j(r,t){r&1&&(n(0,"tr")(1,"th"),o(2,"ID"),i(),n(3,"th"),o(4,"N\xFAmero"),i(),n(5,"th"),o(6,"M\xE9dico"),i(),n(7,"th"),o(8,"Especialidad"),i(),n(9,"th"),o(10,"Fecha Reservada"),i(),n(11,"th"),o(12,"Hora"),i(),n(13,"th"),o(14,"Acci\xF3n"),i()())}function N(r,t){if(r&1){let e=_();n(0,"button",7),f("click",function(){m(e);let c=s().$implicit,p=s();return g(p.confirmDelete(c))}),i()}}function $(r,t){if(r&1){let e=_();n(0,"button",8),f("click",function(){m(e);let c=s().$implicit,p=s();return g(p.liberarCupo(c))}),i()}}function z(r,t){if(r&1){let e=_();n(0,"button",9),f("click",function(){m(e);let c=s().$implicit,p=s();return g(p.cancelDelete(c))}),i()}}function L(r,t){if(r&1&&(n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td"),o(8),i(),n(9,"td"),o(10),P(11,"date"),i(),n(12,"td"),o(13),i(),n(14,"td")(15,"div",3),C(16,N,1,0,"button",4)(17,$,1,0,"button",5)(18,z,1,0,"button",6),i()()()),r&2){let e=t.$implicit;l(2),d(e.id),l(2),d(e.numero),l(2),E("",e.horario==null||e.horario.medicoEspecialidad==null||e.horario.medicoEspecialidad.medico==null||e.horario.medicoEspecialidad.medico.usuario==null?null:e.horario.medicoEspecialidad.medico.usuario.nombre," ",e.horario==null||e.horario.medicoEspecialidad==null||e.horario.medicoEspecialidad.medico==null||e.horario.medicoEspecialidad.medico.usuario==null?null:e.horario.medicoEspecialidad.medico.usuario.apellido,""),l(2),d(e.horario==null||e.horario.medicoEspecialidad==null||e.horario.medicoEspecialidad.especialidad==null?null:e.horario.medicoEspecialidad.especialidad.nombre),l(2),d(O(11,10,e.fechaReservado,"dd/MM/yyyy")),l(3),d(e.hora),l(3),u("ngIf",!e.isDeleting),l(),u("ngIf",e.isDeleting),l(),u("ngIf",e.isDeleting)}}var v=class r{constructor(t,e,a){this.cupoService=t;this.authService=e;this.aseguradoService=a}cupos=[];ngOnInit(){this.cargarReservas()}cargarReservas(){let t=this.authService.getAuthenticatedUserEmail();t?this.aseguradoService.getAseguradoPorCorreo(t).subscribe(e=>{e.id!==void 0?this.cupoService.obtenerCuposPorAsegurado(e.id).subscribe(a=>{this.cupos=a.map(c=>x(h({},c),{isDeleting:!1})),console.log("Cupos obtenidos:",this.cupos)},a=>console.error("Error al obtener cupos:",a)):console.error("El ID del asegurado es undefined.")},e=>console.error("Error al obtener el asegurado:",e)):console.error("No se pudo obtener el correo del asegurado.")}confirmDelete(t){t.isDeleting=!0}cancelDelete(t){t.isDeleting=!1}liberarCupo(t){let e={estado:"Libre"};this.cupoService.reservarCupo(t.id,e).subscribe(a=>{console.log("Cupo liberado exitosamente:",a),t.estado="Libre",t.isDeleting=!1,this.cargarReservas()},a=>{console.error("Error al liberar el cupo:",a),t.isDeleting=!1})}static \u0275fac=function(e){return new(e||r)(b(F),b(D),b(V))};static \u0275cmp=M({type:r,selectors:[["app-mis-reservas"]],standalone:!0,features:[S],decls:5,vars:3,consts:[[3,"value","sortField","sortOrder"],["pTemplate","header"],["pTemplate","body"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","type","button","icon","pi pi-trash","class","p-button-rounded p-button-danger",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-check","class","p-button-rounded p-button-success",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-times","class","p-button-rounded p-button-danger",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"],["pButton","","type","button","icon","pi pi-check",1,"p-button-rounded","p-button-success",3,"click"],["pButton","","type","button","icon","pi pi-times",1,"p-button-rounded","p-button-danger",3,"click"]],template:function(e,a){e&1&&(n(0,"h3"),o(1,"Mis Reservas"),i(),n(2,"p-table",0),C(3,j,15,0,"ng-template",1)(4,L,19,13,"ng-template",2),i()),e&2&&(l(2),u("value",a.cupos)("sortField","id")("sortOrder",1))},dependencies:[B,A,w,I,y,k,T,R],styles:["h3[_ngcontent-%COMP%]{text-align:center;color:#3f51b5;font-weight:700;font-size:1.8rem;margin:0 0 20px;border-bottom:2px solid #ddd;padding-bottom:.5rem}.p-table[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:0 auto;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #00000026}.p-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;font-weight:700;text-align:center;padding:12px}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .3s}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f5f5f5}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e3f2fd}.p-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:center;vertical-align:middle}.p-button-danger[_ngcontent-%COMP%], .p-button-success[_ngcontent-%COMP%]{border:none!important;width:36px;height:36px;display:flex;align-items:center;justify-content:center}.p-button-danger[_ngcontent-%COMP%]{background-color:#e53935!important;color:#fff!important}.p-button-danger[_ngcontent-%COMP%]:hover{background-color:#d32f2f!important}.p-button-success[_ngcontent-%COMP%]{background-color:#43a047!important;color:#fff!important}.p-button-success[_ngcontent-%COMP%]:hover{background-color:#388e3c!important}.flex[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:center;align-items:center}.p-button-rounded[_ngcontent-%COMP%]{border-radius:50%!important}"]})};export{v as default};
