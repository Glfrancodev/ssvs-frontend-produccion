import{a as $}from"./chunk-U3FP4K53.js";import{a as X,b as Y}from"./chunk-BQ34N3PI.js";import{a as me,b as de}from"./chunk-QTW4XJ64.js";import{A as ae,B as ce,d as x,f as G,k as q,l as K,m as J,n as Q,q as Z,s as ee,t as te,u as ie,w as ne,x as oe,y as re,z as se}from"./chunk-6ARW4AJ6.js";import{b as z,d as L,e as N,j as U}from"./chunk-24563CTF.js";import"./chunk-4YRY4IP2.js";import{a as H,b as W,o as j}from"./chunk-PDFVZ3ZT.js";import{m as D,q as F}from"./chunk-5DWL5JJZ.js";import{$a as _,Ab as a,Bb as C,Cb as O,Db as w,Eb as h,Fb as P,Gb as A,Hb as k,Ib as R,Jb as V,Na as d,Oa as b,Q as y,V as M,_ as I,a as E,bc as B,cb as p,ha as l,hb as n,ia as u,ib as o,jb as T,nb as g,qb as f,rb as m}from"./chunk-3RWLLOHT.js";var v=class i{constructor(t,e){this.http=t;this.authService=e}apiUrl="http://localhost:8080/api/permiso-ausencia";getAuthHeaders(){return new H({"Content-Type":"application/json",Authorization:`Bearer ${this.authService.getToken()}`})}getPermisosAusencia(){return this.http.get(this.apiUrl,{headers:this.getAuthHeaders()})}createPermisoAusencia(t){return this.http.post(this.apiUrl,t,{headers:this.getAuthHeaders()})}updatePermisoAusencia(t){return this.http.put(`${this.apiUrl}/${t.id}`,t,{headers:this.getAuthHeaders()})}deletePermisoAusencia(t){return this.http.delete(`${this.apiUrl}/${t}`,{headers:this.getAuthHeaders()})}static \u0275fac=function(e){return new(e||i)(M(W),M(j))};static \u0275prov=y({token:i,factory:i.\u0275fac,providedIn:"root"})};var ge=()=>({"min-width":"50rem","max-width":"100%"});function fe(i,t){if(i&1&&a(0),i&2){let e=t.$implicit;w(" ",e.usuario==null?null:e.usuario.nombre," ",e.usuario==null?null:e.usuario.apellido," ")}}function be(i,t){if(i&1&&a(0),i&2){let e=t.$implicit;w(" ",e.usuario==null?null:e.usuario.nombre," ",e.usuario==null?null:e.usuario.apellido," ")}}function he(i,t){i&1&&(n(0,"tr")(1,"th",16),a(2,"ID"),o(),n(3,"th",17),a(4,"Fecha Permiso"),o(),n(5,"th",18),a(6,"Descripci\xF3n"),o(),n(7,"th",17),a(8,"Estado"),o(),n(9,"th",17),a(10,"M\xE9dico"),o(),n(11,"th",19),a(12,"Acciones"),o()())}function Pe(i,t){if(i&1){let e=g();n(0,"p-dropdown",29),A("ngModelChange",function(c){l(e);let s=m(2).$implicit;return P(s.estado,c)||(s.estado=c),u(c)}),o()}if(i&2){let e=m(2).$implicit,r=m();p("options",r.estadoOptions),h("ngModel",e.estado)}}function Ae(i,t){if(i&1&&_(0,Pe,1,2,"p-dropdown",28),i&2){let e=m().$implicit;p("ngIf",e.estado==="Pendiente")}}function Ce(i,t){if(i&1&&a(0),i&2){let e=m().$implicit;O(" ",e.estado," ")}}function we(i,t){if(i&1){let e=g();n(0,"button",30),f("click",function(){l(e);let c=m().$implicit,s=m();return u(s.onRowEditInit(c))}),o()}}function xe(i,t){if(i&1){let e=g();n(0,"button",31),f("click",function(){l(e);let c=m().$implicit,s=m();return u(s.onRowEditSave(c))}),o()}}function ve(i,t){if(i&1){let e=g();n(0,"button",32),f("click",function(){l(e);let c=m(),s=c.$implicit,pe=c.rowIndex,le=m();return u(le.onRowEditCancel(s,pe))}),o()}}function Me(i,t){if(i&1){let e=g();n(0,"button",33),f("click",function(){l(e);let c=m().$implicit,s=m();return u(s.deletePermisoAusencia(c.id))}),o()}}function Se(i,t){if(i&1&&(n(0,"tr",20)(1,"td"),a(2),o(),n(3,"td"),a(4),o(),n(5,"td"),a(6),o(),n(7,"td")(8,"p-cellEditor"),_(9,Ae,1,1,"ng-template",21)(10,Ce,1,1,"ng-template",22),o()(),n(11,"td"),a(12),o(),n(13,"td")(14,"div",23),_(15,we,1,0,"button",24)(16,xe,1,0,"button",25)(17,ve,1,0,"button",26)(18,Me,1,0,"button",27),o()()()),i&2){let e=t.$implicit,r=t.editing;p("pEditableRow",e),d(2),C(e.id),d(2),C(e.fechaPermiso),d(2),C(e.descripcion),d(6),w("",e.medico==null?null:e.medico.usuario.nombre," ",e.medico==null?null:e.medico.usuario.apellido,""),d(3),p("ngIf",e.estado==="Pendiente"&&!r),d(),p("ngIf",r),d(),p("ngIf",r),d(),p("ngIf",e.estado==="Pendiente"&&!r)}}var S=class i{constructor(t,e,r,c){this.permisoAusenciaService=t;this.medicoService=e;this.messageService=r;this.cdr=c}permisosAusencia=[];medicos=[];estadoOptions=[{label:"Pendiente",value:"Pendiente"},{label:"Aprobado",value:"Aprobado"},{label:"Denegado",value:"Denegado"}];editedPermisosAusencia={};newPermisoAusencia={fechaPermiso:"",descripcion:"",estado:"Pendiente",medico:{id:0,item:"",usuario:{ci:"",correo:"",contrasena:"",nombre:"",apellido:"",estaActivo:!0}}};ngOnInit(){this.getAllPermisosAusencia(),this.getAllMedicos()}getAllPermisosAusencia(){this.permisoAusenciaService.getPermisosAusencia().subscribe(t=>{this.permisosAusencia=t,this.sortPermisosAusencia()})}getAllMedicos(){this.medicoService.getMedicos().subscribe(t=>{this.medicos=t})}sortPermisosAusencia(){this.permisosAusencia.sort((t,e)=>(t.id||0)-(e.id||0))}addPermisoAusencia(){if(!this.newPermisoAusencia.fechaPermiso||!this.newPermisoAusencia.descripcion){this.messageService.add({severity:"warn",summary:"Campos Incompletos",detail:"Por favor, complete todos los campos requeridos"});return}this.permisoAusenciaService.createPermisoAusencia(this.newPermisoAusencia).subscribe(t=>{this.getAllPermisosAusencia(),this.messageService.add({severity:"success",summary:"Permiso de Ausencia Agregado",detail:"Nuevo permiso de ausencia creado correctamente"}),this.newPermisoAusencia={fechaPermiso:"",descripcion:"",estado:"Pendiente",medico:{id:0,item:"",usuario:{ci:"",correo:"",contrasena:"",nombre:"",apellido:"",estaActivo:!0}}}})}onRowEditInit(t){this.editedPermisosAusencia[t.id]=E({},t)}onRowEditSave(t){this.permisoAusenciaService.updatePermisoAusencia(t).subscribe(()=>{delete this.editedPermisosAusencia[t.id],this.messageService.add({severity:"success",summary:"Estado Actualizado",detail:"El estado del permiso ha sido actualizado correctamente"}),this.getAllPermisosAusencia()})}onRowEditCancel(t,e){this.permisosAusencia[e]=this.editedPermisosAusencia[t.id]||t,delete this.editedPermisosAusencia[t.id]}deletePermisoAusencia(t){this.permisoAusenciaService.deletePermisoAusencia(t).subscribe(()=>{this.permisosAusencia=this.permisosAusencia.filter(e=>e.id!==t),this.messageService.add({severity:"success",summary:"Eliminado",detail:"Permiso de ausencia eliminado correctamente"})})}static \u0275fac=function(e){return new(e||i)(b(v),b($),b(x),b(B))};static \u0275cmp=I({type:i,selectors:[["app-permiso-ausencia"]],standalone:!0,features:[k([x]),R],decls:23,vars:7,consts:[[1,"form-container","add-permiso-ausencia-form"],[2,"font-weight","bold"],[1,"form-field"],["for","fechaPermiso"],["id","fechaPermiso","type","date","pInputText","",1,"input-field",3,"ngModelChange","ngModel"],["for","descripcion"],["id","descripcion","type","text","pInputText","","placeholder","Ingrese Descripci\xF3n",1,"input-field",3,"ngModelChange","ngModel"],["for","medico"],["id","medico","optionLabel","nombreCompleto","optionValue","id","placeholder","Seleccione M\xE9dico",1,"input-dropdown",3,"ngModelChange","options","ngModel"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"form-field","center-content"],["label","A\xF1adir Permiso","icon","pi pi-plus","styleClass","p-button-raised p-button-success button-custom",3,"click"],["dataKey","id","editMode","row",3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],[2,"width","10%"],[2,"width","15%"],[2,"width","30%"],[2,"width","20%"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],[1,"action-buttons"],["pButton","","icon","pi pi-pencil","class","p-button-rounded p-button-text","pInitEditableRow","",3,"click",4,"ngIf"],["pButton","","icon","pi pi-check","class","p-button-rounded p-button-success","pSaveEditableRow","",3,"click",4,"ngIf"],["pButton","","icon","pi pi-times","class","p-button-rounded p-button-danger","pCancelEditableRow","",3,"click",4,"ngIf"],["pButton","","icon","pi pi-trash","class","p-button-rounded p-button-danger",3,"click",4,"ngIf"],["optionLabel","label","optionValue","value",3,"options","ngModel","ngModelChange",4,"ngIf"],["optionLabel","label","optionValue","value",3,"ngModelChange","options","ngModel"],["pButton","","icon","pi pi-pencil","pInitEditableRow","",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","icon","pi pi-check","pSaveEditableRow","",1,"p-button-rounded","p-button-success",3,"click"],["pButton","","icon","pi pi-times","pCancelEditableRow","",1,"p-button-rounded","p-button-danger",3,"click"],["pButton","","icon","pi pi-trash",1,"p-button-rounded","p-button-danger",3,"click"]],template:function(e,r){e&1&&(T(0,"p-toast"),n(1,"div",0)(2,"h3",1),a(3,"A\xF1adir Nuevo Permiso de Ausencia"),o(),n(4,"div",2)(5,"label",3),a(6,"Fecha del Permiso"),o(),n(7,"input",4),A("ngModelChange",function(s){return P(r.newPermisoAusencia.fechaPermiso,s)||(r.newPermisoAusencia.fechaPermiso=s),s}),o()(),n(8,"div",2)(9,"label",5),a(10,"Descripci\xF3n"),o(),n(11,"input",6),A("ngModelChange",function(s){return P(r.newPermisoAusencia.descripcion,s)||(r.newPermisoAusencia.descripcion=s),s}),o()(),n(12,"div",2)(13,"label",7),a(14,"M\xE9dico"),o(),n(15,"p-dropdown",8),A("ngModelChange",function(s){return P(r.newPermisoAusencia.medico.id,s)||(r.newPermisoAusencia.medico.id=s),s}),_(16,fe,1,2,"ng-template",9)(17,be,1,2,"ng-template",10),o()(),n(18,"div",11)(19,"p-button",12),f("click",function(){return r.addPermisoAusencia()}),o()()(),n(20,"p-table",13),_(21,he,13,0,"ng-template",14)(22,Se,19,10,"ng-template",15),o()),e&2&&(d(7),h("ngModel",r.newPermisoAusencia.fechaPermiso),d(4),h("ngModel",r.newPermisoAusencia.descripcion),d(4),p("options",r.medicos),h("ngModel",r.newPermisoAusencia.medico.id),d(5),p("value",r.permisosAusencia)("tableStyle",V(6,ge)))},dependencies:[de,me,G,ce,ie,ae,ne,oe,re,se,F,D,U,z,L,N,Q,K,J,q,Y,X,te,ee,Z],styles:[".form-container[_ngcontent-%COMP%]{padding:1.5rem;border:1px solid #dcdcdc;border-radius:12px;background-color:#f9f9f9;box-shadow:0 4px 8px #0000001a;margin-bottom:1.5rem;display:grid;grid-template-columns:1fr 1fr;gap:1rem;max-width:100%;margin:auto}.form-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{grid-column:1 / -1;font-size:1.8rem;font-weight:700;color:#3f51b5;text-align:center;margin:0;margin-bottom:1rem;border-bottom:2px solid #ddd;padding-bottom:.5rem}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333;margin-bottom:.25rem}.input-field[_ngcontent-%COMP%], .input-dropdown[_ngcontent-%COMP%]{width:100%;padding:.5rem;border-radius:6px;border:1px solid #ddd;background-color:#fff;font-size:.95rem;box-shadow:inset 0 1px 3px #0000001a}.input-dropdown[_ngcontent-%COMP%]:focus, .input-field[_ngcontent-%COMP%]:focus{outline:none;border-color:#3f51b5;box-shadow:0 0 4px #3f51b54d}.p-button-success[_ngcontent-%COMP%]{width:100%;max-width:150px;font-size:1rem;border-radius:8px;padding:.75rem;margin:auto}.p-table[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:auto;border-radius:8px;overflow:hidden;box-shadow:0 4px 8px #0000001a;font-size:.95rem}.p-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;font-weight:700;text-align:center;padding:12px}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .3s}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f7f7f7}.p-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#e0f7fa}.p-button-danger[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border-radius:50%;color:#d32f2f!important}.p-button-danger[_ngcontent-%COMP%]:hover{background-color:#d32f2f!important;color:#fff!important}.p-button-rounded.p-button-success[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;color:#43a047!important}.p-button-rounded.p-button-text[_ngcontent-%COMP%]{color:#007bff!important}"]})};export{S as default};
